<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Week 9 BLE: LED on/off control This week, I programmed my Huzzah board to respond to a BLE connection. I downloaded the BLE Scanner app by Bluepixel Technologies onto my iPhone.
Here&amp;rsquo;s what the product looked like:   Here&amp;rsquo;s my code as a code snippet. (Code snippets in markdown can be embedded with 3 backward ticks):
/* Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp Ported to Arduino ESP32 by Evandro Copercini */ #include &amp;lt;BLEDevice.'><title>Week 9</title>

<link rel='canonical' href='https://juhye-m.github.io/ps70/posts/week-9/'>

<link rel="stylesheet" href="/ps70/scss/style.min.css"><meta property='og:title' content='Week 9'>
<meta property='og:description' content='Week 9 BLE: LED on/off control This week, I programmed my Huzzah board to respond to a BLE connection. I downloaded the BLE Scanner app by Bluepixel Technologies onto my iPhone.
Here&amp;rsquo;s what the product looked like:   Here&amp;rsquo;s my code as a code snippet. (Code snippets in markdown can be embedded with 3 backward ticks):
/* Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp Ported to Arduino ESP32 by Evandro Copercini */ #include &amp;lt;BLEDevice.'>
<meta property='og:url' content='https://juhye-m.github.io/ps70/posts/week-9/'>
<meta property='og:site_name' content='JuHye Mun'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:published_time' content='2021-03-27T21:48:03-08:00'/><meta property='article:modified_time' content='2021-03-27T21:48:03-08:00'/>
<meta name="twitter:title" content="Week 9">
<meta name="twitter:description" content="Week 9 BLE: LED on/off control This week, I programmed my Huzzah board to respond to a BLE connection. I downloaded the BLE Scanner app by Bluepixel Technologies onto my iPhone.
Here&amp;rsquo;s what the product looked like:   Here&amp;rsquo;s my code as a code snippet. (Code snippets in markdown can be embedded with 3 backward ticks):
/* Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp Ported to Arduino ESP32 by Evandro Copercini */ #include &amp;lt;BLEDevice.">
    </head>
    <body class="article-page keep-sidebar">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column compact ">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/ps70/img/avatar_hue776a334b902d7828bf5c7a8aa11ccb3_243528_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ðŸ‘¾</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://juhye-m.github.io/ps70/">JuHye Mun</a></h1>
        <h2 class="site-description">Blog for PS70</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/ps70/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/ps70/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        

        
    </ol>
</aside>

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/ps70/posts/week-9/">Week 9</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Mar 27, 2021</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="week-9">Week 9</h2>
<h2 id="ble-led-onoff-control">BLE: LED on/off control</h2>
<p>This week, I programmed my Huzzah board to respond to a BLE connection. I downloaded the <a class="link" href="https://play.google.com/store/apps/details?id=com.macdom.ble.blescanner&amp;hl=en_US"  target="_blank" rel="noopener"
    >BLE Scanner app</a> by Bluepixel Technologies onto my iPhone.</p>
<p>Here&rsquo;s what the product looked like:

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe loading="lazy" src="https://www.youtube.com/embed/tHq3uJSXPic" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
</p>
<p>Here&rsquo;s my code as a code snippet. (Code snippets in markdown can be embedded with 3 backward ticks):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">
<span style="color:#75715e">/*
</span><span style="color:#75715e">    Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp
</span><span style="color:#75715e">    Ported to Arduino ESP32 by Evandro Copercini
</span><span style="color:#75715e">*/</span>

<span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;BLEDevice.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;BLEUtils.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;BLEServer.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// See the following for generating UUIDs:
</span><span style="color:#75715e">// https://www.uuidgenerator.net/
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#define SERVICE_UUID        &#34;4fafc201-1fb5-459e-8fcc-c5c9c331914b&#34;
</span><span style="color:#75715e">#define CHARACTERISTIC_UUID &#34;beb5483e-36e1-4688-b7f5-ea07361b26a8&#34;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> LED_PIN <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
<span style="color:#66d9ef">char</span> LED_STATUS;

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyCallbacks</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> BLECharacteristicCallbacks {
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onWrite</span>(BLECharacteristic <span style="color:#f92672">*</span>pCharacteristic) {
      std<span style="color:#f92672">::</span>string value <span style="color:#f92672">=</span> pCharacteristic<span style="color:#f92672">-&gt;</span>getValue();
      <span style="color:#66d9ef">if</span> (value.length() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) { 
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> value.length(); i<span style="color:#f92672">++</span>){
          LED_STATUS <span style="color:#f92672">=</span> value[i];
        }
      }
    }
};

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
  Serial.begin(<span style="color:#ae81ff">115200</span>);
  BLEDevice<span style="color:#f92672">::</span>init(<span style="color:#e6db74">&#34;JuHye_ESP32&#34;</span>);
  BLEServer <span style="color:#f92672">*</span>pServer <span style="color:#f92672">=</span> BLEDevice<span style="color:#f92672">::</span>createServer();

  BLEService <span style="color:#f92672">*</span>pService <span style="color:#f92672">=</span> pServer<span style="color:#f92672">-&gt;</span>createService(SERVICE_UUID);

  BLECharacteristic <span style="color:#f92672">*</span>pCharacteristic <span style="color:#f92672">=</span> pService<span style="color:#f92672">-&gt;</span>createCharacteristic(
                                         CHARACTERISTIC_UUID,
                                         BLECharacteristic<span style="color:#f92672">::</span>PROPERTY_READ <span style="color:#f92672">|</span>
                                         BLECharacteristic<span style="color:#f92672">::</span>PROPERTY_WRITE
                                       );

  pCharacteristic<span style="color:#f92672">-&gt;</span>setCallbacks(<span style="color:#66d9ef">new</span> MyCallbacks());

  pCharacteristic<span style="color:#f92672">-&gt;</span>setValue(<span style="color:#e6db74">&#34;Hello World&#34;</span>);
  pService<span style="color:#f92672">-&gt;</span>start();

  BLEAdvertising <span style="color:#f92672">*</span>pAdvertising <span style="color:#f92672">=</span> pServer<span style="color:#f92672">-&gt;</span>getAdvertising();
  pAdvertising<span style="color:#f92672">-&gt;</span>start();
  
  pinMode(LED_PIN, OUTPUT);
  digitalWrite(LED_PIN, LOW);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
  <span style="color:#66d9ef">int</span> val <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)LED_STATUS;  <span style="color:#75715e">// cast the char* as an int 
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (val <span style="color:#f92672">==</span> <span style="color:#ae81ff">49</span>)              <span style="color:#75715e">// ASCII code for the number 1
</span><span style="color:#75715e"></span>    digitalWrite(LED_PIN, HIGH);
  <span style="color:#66d9ef">else</span> 
    digitalWrite(LED_PIN, LOW);

  delay(<span style="color:#ae81ff">2000</span>);
}
</code></pre></div><p>BLE Scanner App instructions

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe loading="lazy" src="https://www.youtube.com/embed/JohXpnXMgWg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
</p>
<h2 id="custom-bluetooth-app">Custom Bluetooth app</h2>
<p>React native is a cross-platform mobile application framework using JavaScript that was created by Facebook. It is widely used in app development. You can install react native component libraries, which helps you integrate different functions into your app. I decided to try this out, since I wanted to start creating an app that could work on both Android and iOS.
In order to incorporate BLE functionality, I installed the react-native-ble-plx library from <a class="link" href="https://github.com/Polidea/react-native-ble-plx"  target="_blank" rel="noopener"
    >Polidea&rsquo;s GitHub Repository</a>. I followed along with</p>
<p><figure style="flex-grow: 141; flex-basis: 339px">
		<a href="/ps70/posts/week-9/AppCode.png" data-size="982x694"><img src="/ps70/posts/week-9/AppCode.png"
				srcset="/ps70/posts/week-9/AppCode_hu5e9d2bdaf914d6a68f5510105ca0ccad_119986_480x0_resize_box_2.png 480w, /ps70/posts/week-9/AppCode_hu5e9d2bdaf914d6a68f5510105ca0ccad_119986_1024x0_resize_box_2.png 1024w"
				width="982"
				height="694"
				loading="lazy"
				alt="React App code">
		</a>
		
		<figcaption>React App code</figcaption>
		
	</figure></p>
<h2 id="radio-communication-huzzah-and-esp32-cam">Radio communication: Huzzah and ESP32 Cam</h2>
<p>For this project, I used

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe loading="lazy" src="https://www.youtube.com/embed/CIntOBjuvO4" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
</p>

</section>


    <footer class="article-footer">
    

    </footer>

    
</article>

     
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 JuHye Mun
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.0.1">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">

            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ps70/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
