<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Week 10 Final project This week, I worked a lot on my final project. My final project idea is to create a midi keyboard that can be controlled from different software that allows you to create music, so Digital Audio Workstations. First, in terms of the physical aspect of my product, I needed to think about how I want to implement input. There were different ideas I had, including buttons and copper tape as well as a potentiometer.'><title>Week 10</title>

<link rel='canonical' href='https://juhye-m.github.io/ps70/posts/week-10/'>

<link rel="stylesheet" href="/ps70/scss/style.min.css"><meta property='og:title' content='Week 10'>
<meta property='og:description' content='Week 10 Final project This week, I worked a lot on my final project. My final project idea is to create a midi keyboard that can be controlled from different software that allows you to create music, so Digital Audio Workstations. First, in terms of the physical aspect of my product, I needed to think about how I want to implement input. There were different ideas I had, including buttons and copper tape as well as a potentiometer.'>
<meta property='og:url' content='https://juhye-m.github.io/ps70/posts/week-10/'>
<meta property='og:site_name' content='JuHye Mun'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' />
<meta name="twitter:title" content="Week 10">
<meta name="twitter:description" content="Week 10 Final project This week, I worked a lot on my final project. My final project idea is to create a midi keyboard that can be controlled from different software that allows you to create music, so Digital Audio Workstations. First, in terms of the physical aspect of my product, I needed to think about how I want to implement input. There were different ideas I had, including buttons and copper tape as well as a potentiometer.">
    </head>
    <body class="article-page keep-sidebar">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column compact ">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/ps70/img/avatar_hue776a334b902d7828bf5c7a8aa11ccb3_243528_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ðŸ‘¾</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://juhye-m.github.io/ps70/">JuHye Mun</a></h1>
        <h2 class="site-description">Blog for PS70</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/ps70/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/ps70/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        

        
    </ol>
</aside>

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/ps70/posts/week-10/">Week 10</a>
    </h2>

    </div>
</header>

    <section class="article-content">
    <h2 id="week-10">Week 10</h2>
<h2 id="final-project">Final project</h2>
<p>This week, I worked a lot on my final project. My final project idea is to create a midi keyboard that can be controlled from different software that allows you to create music, so Digital Audio Workstations.
First, in terms of the physical aspect of my product, I needed to think about how I want to implement input. There were different ideas I had, including buttons and copper tape as well as a potentiometer. I plan on using a potentiometer to represent paraneter input. One simple example of this is to control volume. For the keys of the keyboard, since I would need at least an octave (12 keys) that are also flexible and workable with, I decided so far that the best way to do this would be with copper tape. I looked back on the week on capacitance, where we used copper tape, and believe I can make a similar set up where I have one piece of copper tape and another piece that the key would touch when you press it.</p>
<p>Here was my TODO list that I made for the week for final project next-steps.
<figure style="flex-grow: 51; flex-basis: 123px">
		<a href="/ps70/posts/week-10/todo.png" data-size="742x1440"><img src="/ps70/posts/week-10/todo.png"
				srcset="/ps70/posts/week-10/todo_hu25ae63cfc938850d9465dd11247003de_647646_480x0_resize_box_2.png 480w, /ps70/posts/week-10/todo_hu25ae63cfc938850d9465dd11247003de_647646_1024x0_resize_box_2.png 1024w"
				width="742"
				height="1440"
				loading="lazy"
				alt="todo">
		</a>
		
		<figcaption>todo</figcaption>
		
	</figure></p>
<p>Before I worked on all of these elements, however, I needed to work on the software side as well. In order to do that and to make sure that this idea would work, I set up a simple button control ciruit.
Because I wanted to avoid buying more parts including midi input and midi wires, I researched how I could use alternative ways to do this project. I found a few blogs that used &ldquo;Hairless MIDI&rdquo; which is a software that allowed access to the Arduino serial monitor and converted the data to midi. Unfortunately, it turns out that Hairless midi stopped working on the new Mac OS!! This was extrememely disappointing. However, I found a github repository that created a python version of Hairless midi. It was just one man who wrote this up, and there was little documentation.</p>
<p>The code for this is quite long.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> time
<span style="color:#f92672">import</span> queue
<span style="color:#f92672">import</span> rtmidi
<span style="color:#f92672">import</span> serial
<span style="color:#f92672">import</span> threading
<span style="color:#f92672">import</span> logging
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> time
<span style="color:#f92672">import</span> argparse

<span style="color:#75715e"># Serial MIDI Bridge</span>
<span style="color:#75715e"># Ryan Kojima</span>


parser <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Serial MIDI bridge&#34;</span>)

parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--serial_name&#34;</span>, type<span style="color:#f92672">=</span>str, required <span style="color:#f92672">=</span> True, help <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Serial port name. Required&#34;</span>)
parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--baud&#34;</span>, type<span style="color:#f92672">=</span>int, default<span style="color:#f92672">=</span><span style="color:#ae81ff">115200</span>, help <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;baud rate. Default is 115200&#34;</span>)
parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--midi_in_name&#34;</span>, type<span style="color:#f92672">=</span>str, default <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;IAC Bus 1&#34;</span>)
parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--midi_out_name&#34;</span>, type<span style="color:#f92672">=</span>str, default <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;IAC Bus 2&#34;</span>)
parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--debug&#34;</span>, action <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;store_true&#34;</span>, help <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Print incoming / outgoing MIDI signals&#34;</span>)

args <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()

thread_running <span style="color:#f92672">=</span> True

<span style="color:#75715e"># Arguments</span>
serial_port_name <span style="color:#f92672">=</span> args<span style="color:#f92672">.</span>serial_name <span style="color:#75715e">#&#39;/dev/cu.SLAB_USBtoUART&#39;</span>
serial_baud <span style="color:#f92672">=</span> args<span style="color:#f92672">.</span>baud
given_port_name_in <span style="color:#f92672">=</span> args<span style="color:#f92672">.</span>midi_in_name <span style="color:#75715e">#&#34;IAC Bus 1&#34;</span>
given_port_name_out <span style="color:#f92672">=</span> args<span style="color:#f92672">.</span>midi_out_name <span style="color:#75715e">#&#34;IAC Bus 2&#34;</span>

<span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>debug:
    logging<span style="color:#f92672">.</span>basicConfig(level <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>DEBUG)
<span style="color:#66d9ef">else</span>:
    logging<span style="color:#f92672">.</span>basicConfig(level <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>INFO)

midi_ready <span style="color:#f92672">=</span> False
midiin_message_queue <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>Queue()
midiout_message_queue <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>Queue()

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_midi_length</span>(message):
    <span style="color:#66d9ef">if</span> len(message) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">100</span>
    opcode <span style="color:#f92672">=</span> message[<span style="color:#ae81ff">0</span>]
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0xf4</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">in</span> [ <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf3</span> ]:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xf2</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">3</span>
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xf0</span>:
        <span style="color:#66d9ef">if</span> message[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xf7</span>:
            <span style="color:#66d9ef">return</span> len(message)

    opcode <span style="color:#f92672">=</span> opcode <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf0</span>
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">in</span> [ <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xe0</span> ]:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">3</span>
    <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">in</span> [ <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xd0</span> ]:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">100</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">serial_writer</span>():
    <span style="color:#66d9ef">while</span> midi_ready <span style="color:#f92672">==</span> False:
        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.1</span>)
    <span style="color:#66d9ef">while</span> thread_running:
        <span style="color:#66d9ef">try</span>:
            message <span style="color:#f92672">=</span> midiin_message_queue<span style="color:#f92672">.</span>get(timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>)
        <span style="color:#66d9ef">except</span> queue<span style="color:#f92672">.</span>Empty:
            <span style="color:#66d9ef">continue</span>
        logging<span style="color:#f92672">.</span>debug(message)
        value <span style="color:#f92672">=</span> bytearray(message)
        ser<span style="color:#f92672">.</span>write(value)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">serial_watcher</span>():
    receiving_message <span style="color:#f92672">=</span> []
    running_status <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">while</span> midi_ready <span style="color:#f92672">==</span> False:
        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.1</span>)

    <span style="color:#66d9ef">while</span> thread_running:
        data <span style="color:#f92672">=</span> ser<span style="color:#f92672">.</span>read()
        <span style="color:#66d9ef">if</span> data:
            <span style="color:#66d9ef">for</span> elem <span style="color:#f92672">in</span> data:
                receiving_message<span style="color:#f92672">.</span>append(elem)
            <span style="color:#75715e">#Running status</span>
            <span style="color:#66d9ef">if</span> len(receiving_message) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
                <span style="color:#66d9ef">if</span> (receiving_message[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xf0</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
                    running_status <span style="color:#f92672">=</span> receiving_message[<span style="color:#ae81ff">0</span>]
                <span style="color:#66d9ef">else</span>:
                    receiving_message <span style="color:#f92672">=</span> [ running_status, receiving_message[<span style="color:#ae81ff">0</span>] ]

            message_length <span style="color:#f92672">=</span> get_midi_length(receiving_message)
            <span style="color:#66d9ef">if</span> message_length <span style="color:#f92672">&lt;=</span> len(receiving_message):
                logging<span style="color:#f92672">.</span>debug(receiving_message)
                midiout_message_queue<span style="color:#f92672">.</span>put(receiving_message)
                receiving_message <span style="color:#f92672">=</span> []



<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">midi_input_handler</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self, port):
        self<span style="color:#f92672">.</span>port <span style="color:#f92672">=</span> port
        self<span style="color:#f92672">.</span>_wallclock <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()

    <span style="color:#66d9ef">def</span> __call__(self, event, data<span style="color:#f92672">=</span>None):
        message, deltatime <span style="color:#f92672">=</span> event
        self<span style="color:#f92672">.</span>_wallclock <span style="color:#f92672">+=</span> deltatime
        <span style="color:#75715e">#logging.debug(&#34;[%s] @%0.6f %r&#34; % (self.port, self._wallclock, message))</span>
        midiin_message_queue<span style="color:#f92672">.</span>put(message)



<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">midi_watcher</span>():
    <span style="color:#66d9ef">global</span> midi_ready, thread_running

    midiin <span style="color:#f92672">=</span> rtmidi<span style="color:#f92672">.</span>MidiIn()
    midiout <span style="color:#f92672">=</span> rtmidi<span style="color:#f92672">.</span>MidiOut()
    available_ports_out <span style="color:#f92672">=</span> midiout<span style="color:#f92672">.</span>get_ports()
    available_ports_in <span style="color:#f92672">=</span> midiin<span style="color:#f92672">.</span>get_ports()
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;IN : &#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;,&#39;&#34;</span><span style="color:#f92672">.</span>join(available_ports_in) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span>)
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;OUT : &#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;,&#39;&#34;</span><span style="color:#f92672">.</span>join(available_ports_out) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span>)
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;Hit ctrl-c to exit&#34;</span>)

    port_index_in <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    port_index_out <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">for</span> i, s <span style="color:#f92672">in</span> enumerate(available_ports_in):
        <span style="color:#66d9ef">if</span> given_port_name_in <span style="color:#f92672">in</span> s:
            port_index_in <span style="color:#f92672">=</span> i
    <span style="color:#66d9ef">for</span> i, s <span style="color:#f92672">in</span> enumerate(available_ports_out):
        <span style="color:#66d9ef">if</span> given_port_name_out <span style="color:#f92672">in</span> s:
            port_index_out <span style="color:#f92672">=</span> i

    <span style="color:#66d9ef">if</span> port_index_in <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MIDI IN Device name is incorrect. Please use listed device name.&#34;</span>)
    <span style="color:#66d9ef">if</span> port_index_out <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MIDI OUT Device name is incorrect. Please use listed device name.&#34;</span>)
    <span style="color:#66d9ef">if</span> port_index_in <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">or</span> port_index_out <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
        thread_running <span style="color:#f92672">=</span> False
        midi_ready <span style="color:#f92672">=</span> True
        sys<span style="color:#f92672">.</span>exit()

    midiout<span style="color:#f92672">.</span>open_port(port_index_out)
    in_port_name <span style="color:#f92672">=</span> midiin<span style="color:#f92672">.</span>open_port(port_index_in)

    midi_ready <span style="color:#f92672">=</span> True

    midiin<span style="color:#f92672">.</span>ignore_types(sysex <span style="color:#f92672">=</span> False, timing <span style="color:#f92672">=</span> False, active_sense <span style="color:#f92672">=</span> False)
    midiin<span style="color:#f92672">.</span>set_callback(midi_input_handler(in_port_name))

    <span style="color:#66d9ef">while</span> thread_running:
        <span style="color:#66d9ef">try</span>:
            message <span style="color:#f92672">=</span> midiout_message_queue<span style="color:#f92672">.</span>get(timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>)
        <span style="color:#66d9ef">except</span> queue<span style="color:#f92672">.</span>Empty:
            <span style="color:#66d9ef">continue</span>
        midiout<span style="color:#f92672">.</span>send_message(message)


<span style="color:#66d9ef">try</span>:
    ser <span style="color:#f92672">=</span> serial<span style="color:#f92672">.</span>Serial(serial_port_name,serial_baud)
    ser<span style="color:#f92672">.</span>setDTR()
<span style="color:#66d9ef">except</span> serial<span style="color:#f92672">.</span>serialutil<span style="color:#f92672">.</span>SerialException:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Serial port opening error.&#34;</span>)
    midi_watcher()
    sys<span style="color:#f92672">.</span>exit()

ser<span style="color:#f92672">.</span>timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>

s_watcher <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target <span style="color:#f92672">=</span> serial_watcher)
s_writer <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target <span style="color:#f92672">=</span> serial_writer)
m_watcher <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target <span style="color:#f92672">=</span> midi_watcher)

s_watcher<span style="color:#f92672">.</span>start()
s_writer<span style="color:#f92672">.</span>start()
m_watcher<span style="color:#f92672">.</span>start()

<span style="color:#75715e">#Ctrl-C handler</span>
<span style="color:#66d9ef">try</span>:
    <span style="color:#66d9ef">while</span> True:
        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyboardInterrupt</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Terminating.&#34;</span>)
    thread_running <span style="color:#f92672">=</span> False
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)

</code></pre></div><p>In order for this software to work and to communicate between the DAW as well as the serial monitor for my Metro, I had to create new IAP audio inputs and outputs. These are busses that allow for the audio to be channeled later in the DAW.</p>
<p><figure style="flex-grow: 109; flex-basis: 262px">
		<a href="/ps70/posts/week-10/iap.png" data-size="952x870"><img src="/ps70/posts/week-10/iap.png"
				srcset="/ps70/posts/week-10/iap_hu51713f75c615b082285f8b7ffc6c82b8_171107_480x0_resize_box_2.png 480w, /ps70/posts/week-10/iap_hu51713f75c615b082285f8b7ffc6c82b8_171107_1024x0_resize_box_2.png 1024w"
				width="952"
				height="870"
				loading="lazy"
				alt="IAP">
		</a>
		
		<figcaption>IAP</figcaption>
		
	</figure></p>
<p>I had some trouble getting this to work, however. I kept getting the error that my serial port was unable to open.</p>
<p><figure style="flex-grow: 509; flex-basis: 1223px">
		<a href="/ps70/posts/week-10/err.png" data-size="1672x328"><img src="/ps70/posts/week-10/err.png"
				srcset="/ps70/posts/week-10/err_hu0160ec8d2a12cf82f36633c1e9c94be2_273482_480x0_resize_box_2.png 480w, /ps70/posts/week-10/err_hu0160ec8d2a12cf82f36633c1e9c94be2_273482_1024x0_resize_box_2.png 1024w"
				width="1672"
				height="328"
				loading="lazy"
				alt="Error">
		</a>
		
		<figcaption>Error</figcaption>
		
	</figure></p>
<p>After trying different debugging methods, such as looking at the code carefully, checking serial monitor output, and other possible issues, I learned from Professor Melenbrink that the issue is that I can&rsquo;t have the serial monitor open in two places (so when the program runs, that counts), which I was reminded of. Then, I plugged my midi button circuit as input to my DAW, Logic Pro, and here is the result!</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe loading="lazy" src="https://www.youtube.com/embed/0X2GHs5goP4" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>Finally, I also modified a keyboard design that I found on thingiverse. Nathan helped me with this as well!</p>
<h2 id="stepper-motor">Stepper Motor</h2>
<p>During lab, I finished up making my set up for the stepper motor machine design from class. Then, I later hooked it up to the circuit and uploaded the code from class. Unfortunately, when this happened, there was a burning smell that started to come from the machine, and the connection between the breadboard and the power source became incredibly hot.</p>
<p><figure style="flex-grow: 133; flex-basis: 320px">
		<a href="/ps70/posts/week-10/stepper.jpg" data-size="2016x1512"><img src="/ps70/posts/week-10/stepper.jpg"
				srcset="/ps70/posts/week-10/stepper_hu945665fd155ed9d9d09e21b9949562b4_785150_480x0_resize_q75_box.jpg 480w, /ps70/posts/week-10/stepper_hu945665fd155ed9d9d09e21b9949562b4_785150_1024x0_resize_q75_box.jpg 1024w"
				width="2016"
				height="1512"
				loading="lazy"
				alt="Stepper">
		</a>
		
		<figcaption>Stepper</figcaption>
		
	</figure></p>
<p>I had attached this stuffed animal to the rig with some wired hangers, and fortified it with some more tape. I tried to emultate a set up that I did weeks back with my bird that would twirl around. It was a bit too large for the rig, but I taped it to a greek yogurt lid. I wanted to add a button that would control the speed of the stepper motor, so that it would almost emulate a roller coaster ride for the plushie. This would be better than my twirly bird!</p>
<p><figure style="flex-grow: 119; flex-basis: 286px">
		<a href="/ps70/posts/week-10/plush.png" data-size="1184x992"><img src="/ps70/posts/week-10/plush.png"
				srcset="/ps70/posts/week-10/plush_hu6a1a24f1742bfc36f801b0d5de7af745_1608858_480x0_resize_box_2.png 480w, /ps70/posts/week-10/plush_hu6a1a24f1742bfc36f801b0d5de7af745_1608858_1024x0_resize_box_2.png 1024w"
				width="1184"
				height="992"
				loading="lazy"
				alt="Cute plushie">
		</a>
		
		<figcaption>Cute plushie</figcaption>
		
	</figure></p>
<p>I worked on the software component of this assignment, and first did a first pass at taking in a button as input and reading it in to control whether the stepper motor would run or not. The last if statement makes sure that the stepper motor only runs while the button is pressed. Here is my modified code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;AccelStepper.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> stepPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>;  <span style="color:#75715e">// blue
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> dirPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>;   <span style="color:#75715e">// orange
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> buttonPin1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;  <span style="color:#75715e">// still need to collab with board
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// Define a stepper and the pins it will use
</span><span style="color:#75715e"></span>AccelStepper <span style="color:#a6e22e">stepper</span>(<span style="color:#ae81ff">1</span>, stepPin, dirPin); <span style="color:#75715e">// initialise accelstepper for a two wire board
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>()
{
  pinMode(buttonPin1, INPUT);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>()
{
  currentState <span style="color:#f92672">=</span> digitalRead(buttonPin1);
  <span style="color:#66d9ef">if</span> (stepper.distanceToGo() <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
  {
    <span style="color:#75715e">// Random change to speed, position and acceleration
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Make sure we dont get 0 speed or accelerations
</span><span style="color:#75715e"></span>    delay(<span style="color:#ae81ff">1000</span>);
    stepper.moveTo(rand() <span style="color:#f92672">%</span> <span style="color:#ae81ff">1000</span>);
    stepper.setMaxSpeed((rand() <span style="color:#f92672">%</span> <span style="color:#ae81ff">1000</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
    stepper.setAcceleration((rand() <span style="color:#f92672">%</span> <span style="color:#ae81ff">1000</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  }
  <span style="color:#66d9ef">if</span>(currentState <span style="color:#f92672">==</span>  HIGH) {
      stepper.run();
    }
  
}
</code></pre></div><p>I also did research on what I could use a stepper motor to try to integrate it into some final project ideas.
I found a project that used <a class="link" href="https://create.arduino.cc/projecthub/JonJonKayne/arduino-midi-stepper-synth-d291ae"  target="_blank" rel="noopener"
    >stepper motors and midi as well</a>. However, it seemed to use midi as INPUT instead of OUTPUT like I&rsquo;ve been working on, and it used midi pins, so I decided to table this for now.</p>
<h4 id="update">Update</h4>
<p>Motor works! The issue was that one of my voltage wires was accidently connected to ground instead.</p>
<p>Here it is in action!
<figure style="flex-grow: 56; flex-basis: 135px">
		<a href="/ps70/posts/week-10/motor.GIF" data-size="540x960"><img src="/ps70/posts/week-10/motor.GIF"
				srcset="/ps70/posts/week-10/motor_hu332616550bc11f0a51377827a84e3810_14992287_480x0_resize_box.GIF 480w, /ps70/posts/week-10/motor_hu332616550bc11f0a51377827a84e3810_14992287_1024x0_resize_box.GIF 1024w"
				width="540"
				height="960"
				loading="lazy"
				alt="Motor">
		</a>
		
		<figcaption>Motor</figcaption>
		
	</figure></p>

</section>


    <footer class="article-footer">
    

    </footer>

    
</article>

     
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 JuHye Mun
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.0.1">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">

            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ps70/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
