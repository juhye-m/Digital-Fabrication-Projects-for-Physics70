<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Week 4: Microcontroller Programming This week, I created a simple button-controlled music player!
Materials I used the M0 Metro Circuit from Adafruit, a piezo speaker, a button, and the breadboard from the PS 70 kit to start.
I first used the button circuit from class as inspiration. I attached a button and a resistor from ground to one of its legs. Then I connected this leg to digital input 8 so that I can program the button&amp;rsquo;s functionality.'><title>Week 4</title>

<link rel='canonical' href='https://juhye-m.github.io/ps70/posts/week4/'>

<link rel="stylesheet" href="/ps70/scss/style.min.css"><meta property='og:title' content='Week 4'>
<meta property='og:description' content='Week 4: Microcontroller Programming This week, I created a simple button-controlled music player!
Materials I used the M0 Metro Circuit from Adafruit, a piezo speaker, a button, and the breadboard from the PS 70 kit to start.
I first used the button circuit from class as inspiration. I attached a button and a resistor from ground to one of its legs. Then I connected this leg to digital input 8 so that I can program the button&amp;rsquo;s functionality.'>
<meta property='og:url' content='https://juhye-m.github.io/ps70/posts/week4/'>
<meta property='og:site_name' content='JuHye Mun'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:published_time' content='2021-02-22T21:48:03-08:00'/><meta property='article:modified_time' content='2021-02-22T21:48:03-08:00'/>
<meta name="twitter:title" content="Week 4">
<meta name="twitter:description" content="Week 4: Microcontroller Programming This week, I created a simple button-controlled music player!
Materials I used the M0 Metro Circuit from Adafruit, a piezo speaker, a button, and the breadboard from the PS 70 kit to start.
I first used the button circuit from class as inspiration. I attached a button and a resistor from ground to one of its legs. Then I connected this leg to digital input 8 so that I can program the button&amp;rsquo;s functionality.">
    </head>
    <body class="article-page keep-sidebar">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column compact ">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/ps70/img/avatar_hue776a334b902d7828bf5c7a8aa11ccb3_243528_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ðŸ‘¾</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://juhye-m.github.io/ps70/">JuHye Mun</a></h1>
        <h2 class="site-description">Blog for PS70</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/ps70/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/ps70/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        

        
    </ol>
</aside>

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/ps70/posts/week4/">Week 4</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Feb 22, 2021</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="week-4-microcontroller-programming">Week 4: Microcontroller Programming</h2>
<p>This week, I created a simple button-controlled music player!</p>
<h4 id="materials">Materials</h4>
<p>I used the M0 Metro Circuit from Adafruit, a piezo speaker, a button, and the breadboard from the PS 70 kit to start.</p>
<p>I first used the button circuit from class as inspiration. I attached a button and a resistor from ground to one of its legs. Then I connected this leg to digital input 8 so that I can program the button&rsquo;s functionality. Finally I ran 5 volts to the other leg of the button.</p>
<p><figure style="flex-grow: 133; flex-basis: 320px">
		<a href="/ps70/posts/week4/button.jpg" data-size="4032x3024"><img src="/ps70/posts/week4/button.jpg"
				srcset="/ps70/posts/week4/button_hu570d5ceed6bc584168f821fefc1cbe04_1491845_480x0_resize_q75_box.jpg 480w, /ps70/posts/week4/button_hu570d5ceed6bc584168f821fefc1cbe04_1491845_1024x0_resize_q75_box.jpg 1024w"
				width="4032"
				height="3024"
				loading="lazy"
				alt="Button">
		</a>
		
		<figcaption>Button</figcaption>
		
	</figure></p>
<p>Then, I hooked up the piezo speaker! I connected the - leg to ground and the + leg to digital pin 9 to upload instructions to the piezo.</p>
<p><figure style="flex-grow: 133; flex-basis: 320px">
		<a href="/ps70/posts/week4/circuit.jpg" data-size="4032x3024"><img src="/ps70/posts/week4/circuit.jpg"
				srcset="/ps70/posts/week4/circuit_huc1ac7e79c5c35bcb9de0fddbf7f368ea_1987237_480x0_resize_q75_box.jpg 480w, /ps70/posts/week4/circuit_huc1ac7e79c5c35bcb9de0fddbf7f368ea_1987237_1024x0_resize_q75_box.jpg 1024w"
				width="4032"
				height="3024"
				loading="lazy"
				alt="Circuit">
		</a>
		
		<figcaption>Circuit</figcaption>
		
	</figure></p>
<!-- raw HTML omitted -->
<h4 id="code">Code</h4>
<p>I got the initial code for the music from this <a class="link" href="https://learn.adafruit.com/experimenters-guide-for-metro/circ06-code"  target="_blank" rel="noopener"
    >Adafruit Guide!</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">// CIRC06 - Music with Piezo
</span><span style="color:#75715e"></span>  
<span style="color:#66d9ef">int</span> speakerPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
<span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>; <span style="color:#75715e">// the number of notes
</span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> notes[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ccggaagffeeddc &#34;</span>; <span style="color:#75715e">// a space represents a rest
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> beats[] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span> };
<span style="color:#66d9ef">int</span> tempo <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>;
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">playNote</span>(<span style="color:#66d9ef">char</span> note, <span style="color:#66d9ef">int</span> duration) {
  <span style="color:#66d9ef">char</span> names[] <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;d&#39;</span>, <span style="color:#e6db74">&#39;e&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;g&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span> };
  <span style="color:#66d9ef">int</span> tones[] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">1915</span>, <span style="color:#ae81ff">1700</span>, <span style="color:#ae81ff">1519</span>, <span style="color:#ae81ff">1432</span>, <span style="color:#ae81ff">1275</span>, <span style="color:#ae81ff">1136</span>, <span style="color:#ae81ff">1014</span>, <span style="color:#ae81ff">956</span> };  
  <span style="color:#75715e">// play the tone corresponding to the note name
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {
    <span style="color:#66d9ef">if</span> (names[i] <span style="color:#f92672">==</span> note) {
      tone(speakerPin, tones[i], duration);
    }
  }
}
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
  pinMode(speakerPin, OUTPUT);
}
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
    <span style="color:#66d9ef">if</span> (notes[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>) {
      delay(beats[i] <span style="color:#f92672">*</span> tempo); <span style="color:#75715e">// rest
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
      playNote(notes[i], beats[i] <span style="color:#f92672">*</span> tempo);
    }
    
    <span style="color:#75715e">// pause between notes
</span><span style="color:#75715e"></span>    delay(tempo <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>); 
  }
}
</code></pre></div><p>Using this as the starting point for my program, I adapted the code to play a different tune.
I did this by changing the array of characters, notes, which is a string, from &ldquo;ccggaagffeeddc &quot; to &ldquo;ccggaag ffeeddcc&rdquo;. Because the tones are already associated with the note names in the play note function, this is sufficient to change the notes that are played. The tones in the play note function are frequencies.</p>
<p>You can learn more about the tone function in the <a class="link" href="https://www.arduino.cc/reference/en/language/functions/advanced-io/tone/"  target="_blank" rel="noopener"
    >arduino manual</a>. The tone function takes as input a frequency, and outputs a square wave of that frequency. In the code above, we see that the tone() function takes in 3 arguments, with the latter being optional: pin, frequency, duration.</p>
<p>I modified the &ldquo;play note&rdquo; function as well, in order to shift down the tones by an octave. To get the proper frequencies for the notes, I referenced this <a class="link" href="https://pages.mtu.edu/~suits/notefreqs.html"  target="_blank" rel="noopener"
    >chart of frequencies</a>.</p>
<p><figure style="flex-grow: 48; flex-basis: 116px">
		<a href="/ps70/posts/week4/chart.png" data-size="368x756"><img src="/ps70/posts/week4/chart.png"
				srcset="/ps70/posts/week4/chart_huf204a0cb1966211cdab5f6ffd97488ca_72100_480x0_resize_box_2.png 480w, /ps70/posts/week4/chart_huf204a0cb1966211cdab5f6ffd97488ca_72100_1024x0_resize_box_2.png 1024w"
				width="368"
				height="756"
				loading="lazy"
				alt="Tone frequencies">
		</a>
		
		<figcaption>Tone frequencies</figcaption>
		
	</figure></p>
<p>Then, I rounded the frequencies to the nearest integer, because the tone function only takes as input an unsigned integer.</p>
<p>Here is the modified code that I wrote:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">int</span> speakerPin <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
<span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>; <span style="color:#75715e">// the number of notes
</span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> notes[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ccggaag ffeeddcc&#34;</span>; <span style="color:#75715e">// a space represents a rest
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> beats[] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span> };
<span style="color:#66d9ef">int</span> tempo <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>;
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">playNote</span>(<span style="color:#66d9ef">char</span> note, <span style="color:#66d9ef">int</span> duration) {
  <span style="color:#66d9ef">char</span> names[] <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;d&#39;</span>, <span style="color:#e6db74">&#39;e&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;g&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span> };
  <span style="color:#66d9ef">int</span> tones[] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">523</span>, <span style="color:#ae81ff">587</span>, <span style="color:#ae81ff">659</span>, <span style="color:#ae81ff">698</span>, <span style="color:#ae81ff">784</span>, <span style="color:#ae81ff">880</span>, <span style="color:#ae81ff">988</span>, <span style="color:#ae81ff">1047</span> };  
  <span style="color:#75715e">// play the tone corresponding to the note name
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {
    <span style="color:#66d9ef">if</span> (names[i] <span style="color:#f92672">==</span> note) {
      tone(speakerPin, tones[i], duration);
    }
  }
}
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
  pinMode(speakerPin, OUTPUT);
}
 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span>() {
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
    <span style="color:#66d9ef">if</span> (notes[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>) {
      delay(beats[i] <span style="color:#f92672">*</span> tempo); <span style="color:#75715e">// rest
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
      playNote(notes[i], beats[i] <span style="color:#f92672">*</span> tempo);
    }
    
    <span style="color:#75715e">// pause between notes
</span><span style="color:#75715e"></span>    delay(tempo <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>); 
  }
}
</code></pre></div><h4 id="and-tada">And&hellip; TADA!</h4>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe loading="lazy" src="https://www.youtube.com/embed/B8eITQbo8LA" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


</section>


    <footer class="article-footer">
    

    </footer>

    
</article>

     
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 JuHye Mun
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.0.1">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">

            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ps70/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
